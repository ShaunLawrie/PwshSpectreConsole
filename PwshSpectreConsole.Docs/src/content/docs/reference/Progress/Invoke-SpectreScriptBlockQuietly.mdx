---
sidebar:
  badge:
    text: New
    variant: tip
title: Invoke-SpectreScriptBlockQuietly
---



import Asciinema from '../../../../components/Asciinema.astro'

### Description

This function invokes a script block in a background job and returns the output. It also provides an option to suppress the output even more if there is garbage being printed to stderr if using Level = Quieter.

---

### Examples
> EXAMPLE 1

```powershell
Invoke-SpectreCommandWithProgress {
    param (
        $Context
    )
    $task1 = $Context.AddTask("Starting a process that generates noise")
    $task1.Increment(50)
    $value = Invoke-SpectreScriptBlockQuietly -Level Quiet -Command {
        Write-Output "Things..."
        Write-Output "And stuff..."
        Write-Error "This is an error"
        Start-Sleep -Seconds 3
        git checkout nonexistentbranch
        Write-Output "But it shouldn't break progress bar rendering"
    }
    $task1.Increment(50)
    Write-SpectreHost ($value | Get-SpectreEscapedText)
}
```
<Asciinema
    src="/examples/invokespectrescriptblockquietlyExample1.cast"
    settings={{
        loop: false,
        poster: 'npt:0:0',
        terminalLineHeight: 1.1,
        theme: "spectre"
    }}
/>

---

### Parameters
#### **Command**
The script block to be invoked.

|Type           |Required|Position|PipelineInput|
|---------------|--------|--------|-------------|
|`[ScriptBlock]`|false   |1       |false        |

#### **Level**
Suppresses the output by varying amounts.
Valid Values:

* Quiet
* Quieter

|Type      |Required|Position|PipelineInput|
|----------|--------|--------|-------------|
|`[String]`|false   |2       |false        |

---

### Syntax
```powershell
Invoke-SpectreScriptBlockQuietly [[-Command] <ScriptBlock>] [[-Level] <String>] [<CommonParameters>]
```
